function Tau = spice(S,Theta)
% SPICE     - 'Spiciness', an oceanographic variable for characterization 
%              of intrusions and water masses
%
% Spiceness is orthogonal to isopycnals of potential density
%
% Use as: Tau = spice(S,Theta)
%
% Inputs: S     = Salinity (psu)
%         Theta = Potential temperature (C)
%
% Output: Tau   = spiciness

% Brian Schlining
% 07 Oct 1997
% Algorythmn from P. Flament, Subduction and finestructure associated
% with upwelling filaments. Ph. D. Dissertation. University of 
% California, San Diego. Vol 32. No.10. pp.1195 to 1207. 1985

%=====================================================================
% Table of Coefficients b(i,j) of polynomial expression for spiciness
%=====================================================================
b = [  0           7.7442e-1 -5.85e-3   -9.84e-4   -2.06e-4;...
       5.1655e-2   2.034e-3  -2.742e-4  -8.5e-6     1.36e-5;...
       6.64783e-3 -2.4681e-4 -1.428e-5   3.337e-5   7.894e-6;...
      -5.4023e-5   7.326e-6   7.0036e-6 -3.0412e-6 -1.0853e-6;...
       3.949e-7   -3.029e-8  -3.8209e-7  1.0012e-7  4.7133e-8;...
      -6.36e-10   -1.309e-9   6.048e-9  -1.1409e-9 -6.676e-10]; 

%===================================== 
% Polynomial calculation of spiciness
%=====================================
Tau = b(1,1).*Theta.^0.*(S-35).^0 + ...
      b(1,2).*Theta.^0.*(S-35).^1 + ...
      b(1,3).*Theta.^0.*(S-35).^2 + ...
      b(1,4).*Theta.^0.*(S-35).^3 + ...
      b(1,5).*Theta.^0.*(S-35).^4 + ...
      b(2,1).*Theta.^1.*(S-35).^0 + ...
      b(2,2).*Theta.^1.*(S-35).^1 + ...
      b(2,3).*Theta.^1.*(S-35).^2 + ...
      b(2,4).*Theta.^1.*(S-35).^3 + ...
      b(2,5).*Theta.^1.*(S-35).^4 + ...
      b(3,1).*Theta.^2.*(S-35).^0 + ...
      b(3,2).*Theta.^2.*(S-35).^1 + ...
      b(3,3).*Theta.^2.*(S-35).^2 + ...
      b(3,4).*Theta.^2.*(S-35).^3 + ...
      b(3,5).*Theta.^2.*(S-35).^4 + ...
      b(4,1).*Theta.^3.*(S-35).^0 + ...
      b(4,2).*Theta.^3.*(S-35).^1 + ...
      b(4,3).*Theta.^3.*(S-35).^2 + ...
      b(4,4).*Theta.^3.*(S-35).^3 + ...
      b(4,5).*Theta.^3.*(S-35).^4 + ...
      b(5,1).*Theta.^4.*(S-35).^0 + ...
      b(5,2).*Theta.^4.*(S-35).^1 + ...
      b(5,3).*Theta.^4.*(S-35).^2 + ...
      b(5,4).*Theta.^4.*(S-35).^3 + ...
      b(5,5).*Theta.^4.*(S-35).^4 + ...
      b(6,1).*Theta.^5.*(S-35).^0 + ...
      b(6,2).*Theta.^5.*(S-35).^1 + ...
      b(6,3).*Theta.^5.*(S-35).^2 + ...
      b(6,4).*Theta.^5.*(S-35).^3 + ...
      b(6,5).*Theta.^5.*(S-35).^4;
   
